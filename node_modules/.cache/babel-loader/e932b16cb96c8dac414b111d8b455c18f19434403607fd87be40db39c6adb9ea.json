{"ast":null,"code":"import _objectSpread from \"/home/academy9/\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B/MobX/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport { makeAutoObservable } from \"mobx\";\nimport { updateTask, handleAddTask, fetchTasks as apiFetchTasks } from \"../api\";\nclass TodoStore {\n  constructor() {\n    this.tasks = [];\n    this.newTaskText = \"\";\n    this.editingTask = null;\n    this.message = \"\";\n    makeAutoObservable(this);\n  }\n  async fetchInitialTasks() {\n    try {\n      const fetchedTasks = await apiFetchTasks();\n      this.tasks = fetchedTasks;\n      this.message = \"❗Tasks loaded from server❗\";\n    } catch (error) {\n      console.error(\"Error fetching tasks:\", error);\n      this.message = \"❗Error loading tasks❗\";\n    }\n  }\n  addTask() {\n    if (!this.newTaskText.trim()) return;\n    handleAddTask(this.newTaskText).then(newTask => {\n      this.tasks.push(newTask);\n      this.newTaskText = \"\";\n    });\n  }\n  async deleteTask(id) {\n    const task = this.tasks.find(task => task.id === id);\n    if (task) {\n      await handleDeleteTask(task.documentId);\n      this.tasks = this.tasks.filter(task => task.id !== id);\n    }\n  }\n  async toggleTask(id) {\n    const taskIndex = this.tasks.findIndex(task => task.id === id);\n    if (taskIndex !== -1) {\n      const updatedTask = this.tasks[taskIndex];\n      await updateTask(updatedTask.documentId, !updatedTask.completed, updatedTask.text);\n      this.tasks[taskIndex].completed = !this.tasks[taskIndex].completed;\n    }\n  }\n  markAllCompleted() {\n    this.tasks = this.tasks.map(task => _objectSpread(_objectSpread({}, task), {}, {\n      completed: true\n    }));\n  }\n  deleteCompleted() {\n    this.tasks = this.tasks.filter(task => !task.completed);\n  }\n  startEditingTask(task) {\n    this.editingTask = task;\n  }\n  cancelEditingTask() {\n    this.editingTask = null;\n  }\n  updateTaskInStore(updatedTask) {\n    if (updatedTask.text.trim() === \"\") return;\n    const taskIndex = this.tasks.findIndex(task => task.documentId === updatedTask.documentId);\n    if (taskIndex !== -1) {\n      updateTask(updatedTask.documentId, updatedTask.completed, updatedTask.text).then(() => {\n        this.tasks[taskIndex] = updatedTask;\n      });\n    }\n    this.editingTask = null;\n  }\n  setNewTaskText(text) {\n    this.newTaskText = text;\n  }\n}\nexport default new TodoStore();","map":{"version":3,"names":["makeAutoObservable","updateTask","handleAddTask","fetchTasks","apiFetchTasks","TodoStore","constructor","tasks","newTaskText","editingTask","message","fetchInitialTasks","fetchedTasks","error","console","addTask","trim","then","newTask","push","deleteTask","id","task","find","handleDeleteTask","documentId","filter","toggleTask","taskIndex","findIndex","updatedTask","completed","text","markAllCompleted","map","_objectSpread","deleteCompleted","startEditingTask","cancelEditingTask","updateTaskInStore","setNewTaskText"],"sources":["/home/academy9/Документы/MobX/src/store/todoStore.ts"],"sourcesContent":["import { makeAutoObservable } from \"mobx\";\nimport { TaskItem } from \"../types\";\nimport { updateTask, handleAddTask, fetchTasks as apiFetchTasks } from \"../api\";\n\nclass TodoStore {\n    tasks: TaskItem[] = [];\n    newTaskText: string = \"\";\n    editingTask: TaskItem | null = null;\n    message: string = \"\";\n    \n    constructor() {\n        makeAutoObservable(this);\n    }\n\n    async fetchInitialTasks() {\n        try {\n            const fetchedTasks = await apiFetchTasks();\n            this.tasks = fetchedTasks;\n            this.message = \"❗Tasks loaded from server❗\";\n        } catch (error) {\n            console.error(\"Error fetching tasks:\", error);\n            this.message = \"❗Error loading tasks❗\";\n        }\n    }\n\n    addTask() {\n        if (!this.newTaskText.trim()) return;\n\n        handleAddTask(this.newTaskText).then((newTask) => {\n            this.tasks.push(newTask);\n            this.newTaskText = \"\";\n        });\n    }\n\n    async deleteTask(id: number) {\n        const task = this.tasks.find((task) => task.id === id);\n        if (task) {\n            await handleDeleteTask(task.documentId);\n            this.tasks = this.tasks.filter((task) => task.id !== id);\n        }\n    }\n\n    async toggleTask(id: number) {\n        const taskIndex = this.tasks.findIndex((task) => task.id === id);\n        if (taskIndex !== -1) {\n            const updatedTask = this.tasks[taskIndex];\n            await updateTask(\n                updatedTask.documentId,\n                !updatedTask.completed,\n                updatedTask.text\n            );\n            this.tasks[taskIndex].completed = !this.tasks[taskIndex].completed;\n        }\n    }\n\n    markAllCompleted() {\n        this.tasks = this.tasks.map((task) => ({ ...task, completed: true }));\n    }\n\n    deleteCompleted() {\n        this.tasks = this.tasks.filter((task) => !task.completed);\n    }\n\n    startEditingTask(task: TaskItem) {\n        this.editingTask = task;\n    }\n\n    cancelEditingTask() {\n        this.editingTask = null;\n    }\n\n    updateTaskInStore(updatedTask: TaskItem) {\n        if (updatedTask.text.trim() === \"\") return;\n      \n        const taskIndex = this.tasks.findIndex((task) => task.documentId === updatedTask.documentId);\n        if (taskIndex !== -1) {\n            updateTask(updatedTask.documentId, updatedTask.completed, updatedTask.text).then(() => {\n                this.tasks[taskIndex] = updatedTask;\n            });\n        }\n      \n        this.editingTask = null;\n    }\n      \n    setNewTaskText(text: string) {\n        this.newTaskText = text;\n    }\n}\n\nexport default new TodoStore();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}