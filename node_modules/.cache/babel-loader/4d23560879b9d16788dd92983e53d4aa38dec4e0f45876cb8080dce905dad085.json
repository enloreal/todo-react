{"ast":null,"code":"import _objectSpread from \"/home/academy9/\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B/MobX/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport { makeAutoObservable } from \"mobx\";\nimport { fetchTasks, handleAddTask, updateTask, handleDeleteTask } from \"../api\";\nclass TodoStore {\n  constructor() {\n    this.tasks = [];\n    this.newTaskText = \"\";\n    this.editingTask = null;\n    this.message = \"\";\n    this.isLoading = false;\n    makeAutoObservable(this);\n  }\n  async fetchInitialTasks() {\n    this.isLoading = true;\n    this.message = \"\";\n    try {\n      const fetchedTasks = await fetchTasks();\n      this.tasks = fetchedTasks;\n      this.message = \"❗Tasks loaded from server❗\";\n    } catch (error) {\n      console.error(\"Error fetching tasks:\", error);\n      this.tasks = [];\n      this.message = \"❗Error loading tasks. Check your internet connection or Strapi server.❗\";\n    } finally {\n      this.isLoading = false;\n    }\n  }\n  async addTask() {\n    if (!this.newTaskText.trim()) return;\n    try {\n      const newTask = await handleAddTask(this.newTaskText);\n      this.tasks.push(newTask);\n      this.newTaskText = \"\";\n    } catch (error) {\n      console.error('Error adding task:', error);\n      this.message = \"❗Failed to add task. Please try again later.❗\";\n    }\n  }\n  async deleteTask(id) {\n    try {\n      await handleDeleteTask(id);\n      this.tasks = this.tasks.filter(task => task.id !== id);\n    } catch (error) {\n      console.error('Error deleting task:', error);\n      this.message = \"❗Failed to delete task. Please try again later.❗\";\n    }\n  }\n  async toggleTask(id) {\n    const task = this.tasks.find(t => t.id === id);\n    if (task) {\n      try {\n        const updatedTask = _objectSpread(_objectSpread({}, task), {}, {\n          completed: !task.completed\n        });\n        await updateTask(updatedTask);\n        const taskIndex = this.tasks.findIndex(t => t.id === id);\n        if (taskIndex !== -1) {\n          this.tasks[taskIndex] = updatedTask;\n        }\n      } catch (error) {\n        console.error(\"Error toggling task:\", error);\n        this.message = \"❗Failed to update task. Please try again later.❗\";\n      }\n    }\n  }\n  markAllCompleted() {\n    this.tasks.forEach(async task => {\n      if (!task.completed) {\n        try {\n          await updateTask(_objectSpread(_objectSpread({}, task), {}, {\n            completed: true\n          }));\n          task.completed = true;\n        } catch (error) {\n          console.error(\"Error marking all tasks completed:\", error);\n          this.message = \"❗Failed to mark all tasks completed. Please try again later.❗\";\n        }\n      }\n    });\n  }\n  deleteCompleted() {\n    const completedTasks = this.tasks.filter(task => task.completed);\n    completedTasks.forEach(async completedTask => {\n      try {\n        await handleDeleteTask(completedTask.id);\n        this.tasks = this.tasks.filter(task => !task.completed);\n      } catch (error) {\n        console.error(\"Error deleting completed tasks:\", error);\n        this.message = \"❗Failed to delete completed tasks. Please try again later.❗\";\n      }\n    });\n  }\n  startEditingTask(task) {\n    this.editingTask = _objectSpread({}, task);\n  }\n  cancelEditingTask() {\n    this.editingTask = null;\n  }\n  async updateTask(updatedTask) {\n    try {\n      await updateTask(updatedTask);\n      const taskIndex = this.tasks.findIndex(task => task.id === updatedTask.id);\n      if (taskIndex !== -1) {\n        this.tasks[taskIndex] = updatedTask;\n        this.editingTask = null;\n      }\n    } catch (error) {\n      console.error(\"Error updating task:\", error);\n      this.message = \"❗Failed to update task. Please try again later.❗\";\n    }\n  }\n  setNewTaskText(text) {\n    this.newTaskText = text;\n  }\n}\nexport default new TodoStore();","map":{"version":3,"names":["makeAutoObservable","fetchTasks","handleAddTask","updateTask","handleDeleteTask","TodoStore","constructor","tasks","newTaskText","editingTask","message","isLoading","fetchInitialTasks","fetchedTasks","error","console","addTask","trim","newTask","push","deleteTask","id","filter","task","toggleTask","find","t","updatedTask","_objectSpread","completed","taskIndex","findIndex","markAllCompleted","forEach","deleteCompleted","completedTasks","completedTask","startEditingTask","cancelEditingTask","setNewTaskText","text"],"sources":["/home/academy9/Документы/MobX/src/store/todoStore.ts"],"sourcesContent":["import { makeAutoObservable } from \"mobx\";\nimport { TaskItem } from \"../types\";\nimport { fetchTasks, handleAddTask, updateTask, handleDeleteTask } from \"../api\";\n\nclass TodoStore {\n    tasks: TaskItem[] = [];\n    newTaskText: string = \"\";\n    editingTask: TaskItem | null = null;\n    message: string = \"\";\n    isLoading: boolean = false;\n\n    constructor() {\n        makeAutoObservable(this);\n    }\n\n    async fetchInitialTasks() {\n        this.isLoading = true;\n        this.message = \"\";\n\n        try {\n            const fetchedTasks = await fetchTasks();\n            this.tasks = fetchedTasks;\n            this.message = \"❗Tasks loaded from server❗\";\n        } catch (error: any) {\n            console.error(\"Error fetching tasks:\", error);\n            this.tasks = [];\n            this.message = \"❗Error loading tasks. Check your internet connection or Strapi server.❗\";\n        } finally {\n            this.isLoading = false;\n        }\n    }\n\n    async addTask() {\n        if (!this.newTaskText.trim()) return;\n        try {\n            const newTask = await handleAddTask(this.newTaskText);\n            this.tasks.push(newTask);\n            this.newTaskText = \"\";\n        } catch (error) {\n            console.error('Error adding task:', error);\n            this.message = \"❗Failed to add task. Please try again later.❗\";\n        }\n    }\n\n    async deleteTask(id: number) {\n        try {\n            await handleDeleteTask(id);\n            this.tasks = this.tasks.filter((task) => task.id !== id);\n        } catch (error) {\n            console.error('Error deleting task:', error);\n            this.message = \"❗Failed to delete task. Please try again later.❗\";\n        }\n    }\n\n    async toggleTask(id: number) {\n        const task = this.tasks.find((t) => t.id === id);\n        if (task) {\n            try {\n                const updatedTask = { ...task, completed: !task.completed };\n                await updateTask(updatedTask);\n                const taskIndex = this.tasks.findIndex((t) => t.id === id);\n                if (taskIndex !== -1) {\n                    this.tasks[taskIndex] = updatedTask;\n                }\n            } catch (error) {\n                console.error(\"Error toggling task:\", error);\n                this.message = \"❗Failed to update task. Please try again later.❗\";\n            }\n        }\n    }\n\n    markAllCompleted() {\n      this.tasks.forEach(async (task) => {\n        if (!task.completed) {\n          try {\n              await updateTask({...task, completed: true})\n              task.completed = true;\n          } catch (error) {\n              console.error(\"Error marking all tasks completed:\", error);\n              this.message = \"❗Failed to mark all tasks completed. Please try again later.❗\";\n          }\n        }\n      })\n    }\n\n    deleteCompleted() {\n      const completedTasks = this.tasks.filter(task => task.completed)\n      completedTasks.forEach(async (completedTask) => {\n          try {\n              await handleDeleteTask(completedTask.id)\n              this.tasks = this.tasks.filter((task) => !task.completed);\n          } catch (error) {\n              console.error(\"Error deleting completed tasks:\", error);\n              this.message = \"❗Failed to delete completed tasks. Please try again later.❗\";\n          }\n      })\n    }\n\n\n    startEditingTask(task: TaskItem) {\n        this.editingTask = { ...task };\n    }\n\n    cancelEditingTask() {\n        this.editingTask = null;\n    }\n\n    async updateTask(updatedTask: TaskItem) {\n        try {\n            await updateTask(updatedTask);\n            const taskIndex = this.tasks.findIndex((task) => task.id === updatedTask.id);\n            if (taskIndex !== -1) {\n                this.tasks[taskIndex] = updatedTask;\n                this.editingTask = null;\n            }\n        } catch (error) {\n            console.error(\"Error updating task:\", error);\n            this.message = \"❗Failed to update task. Please try again later.❗\";\n        }\n    }\n\n    setNewTaskText(text: string) {\n        this.newTaskText = text;\n    }\n}\n\nexport default new TodoStore();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}